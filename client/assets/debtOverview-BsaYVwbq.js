import{r as i,l as e}from"./chunk-KNED5TY2-aB5C0GE7.js";import{B as I}from"./button-BVG67S5E.js";import{D as O,a as z,b as F,c as L,e as A,d as S}from"./dialog-bh4Rpo9L.js";import{M as B,u as M,P as H,a as W,b as K,L as T,m as U}from"./proxy-DKvFvltC.js";class G extends i.Component{getSnapshotBeforeUpdate(a){const s=this.props.childRef.current;if(s&&a.isPresent&&!this.props.isPresent){const r=s.offsetParent,c=r instanceof HTMLElement&&r.offsetWidth||0,l=this.props.sizeRef.current;l.height=s.offsetHeight||0,l.width=s.offsetWidth||0,l.top=s.offsetTop,l.left=s.offsetLeft,l.right=c-l.width-l.left}return null}componentDidUpdate(){}render(){return this.props.children}}function V({children:n,isPresent:a,anchorX:s}){const r=i.useId(),c=i.useRef(null),l=i.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:f}=i.useContext(B);return i.useInsertionEffect(()=>{const{width:p,height:o,top:u,left:t,right:g}=l.current;if(a||!c.current||!p||!o)return;const m=s==="left"?`left: ${t}`:`right: ${g}`;c.current.dataset.motionPopId=r;const h=document.createElement("style");return f&&(h.nonce=f),document.head.appendChild(h),h.sheet&&h.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${p}px !important;
            height: ${o}px !important;
            ${m}px !important;
            top: ${u}px !important;
          }
        `),()=>{document.head.removeChild(h)}},[a]),e.jsx(G,{isPresent:a,childRef:c,sizeRef:l,children:i.cloneElement(n,{ref:c})})}const X=({children:n,initial:a,isPresent:s,onExitComplete:r,custom:c,presenceAffectsLayout:l,mode:f,anchorX:p})=>{const o=M(_),u=i.useId(),t=i.useCallback(m=>{o.set(m,!0);for(const h of o.values())if(!h)return;r&&r()},[o,r]),g=i.useMemo(()=>({id:u,initial:a,isPresent:s,custom:c,onExitComplete:t,register:m=>(o.set(m,!1),()=>o.delete(m))}),l?[Math.random(),t]:[s,t]);return i.useMemo(()=>{o.forEach((m,h)=>o.set(h,!1))},[s]),i.useEffect(()=>{!s&&!o.size&&r&&r()},[s]),f==="popLayout"&&(n=e.jsx(V,{isPresent:s,anchorX:p,children:n})),e.jsx(H.Provider,{value:g,children:n})};function _(){return new Map}const b=n=>n.key||"";function P(n){const a=[];return i.Children.forEach(n,s=>{i.isValidElement(s)&&a.push(s)}),a}const q=({children:n,custom:a,initial:s=!0,onExitComplete:r,presenceAffectsLayout:c=!0,mode:l="sync",propagate:f=!1,anchorX:p="left"})=>{const[o,u]=W(f),t=i.useMemo(()=>P(n),[n]),g=f&&!o?[]:t.map(b),m=i.useRef(!0),h=i.useRef(t),C=M(()=>new Map),[k,R]=i.useState(t),[j,E]=i.useState(t);K(()=>{m.current=!1,h.current=t;for(let x=0;x<j.length;x++){const d=b(j[x]);g.includes(d)?C.delete(d):C.get(d)!==!0&&C.set(d,!1)}},[j,g.length,g.join("-")]);const v=[];if(t!==k){let x=[...t];for(let d=0;d<j.length;d++){const y=j[d],w=b(y);g.includes(w)||(x.splice(d,0,y),v.push(y))}return l==="wait"&&v.length&&(x=v),E(P(x)),R(t),null}const{forceRender:N}=i.useContext(T);return e.jsx(e.Fragment,{children:j.map(x=>{const d=b(x),y=f&&!o?!1:t===j||g.includes(d),w=()=>{if(C.has(d))C.set(d,!0);else return;let D=!0;C.forEach($=>{$||(D=!1)}),D&&(N==null||N(),E(h.current),f&&(u==null||u()),r&&r())};return e.jsx(X,{isPresent:y,initial:!m.current||s?void 0:!1,custom:a,presenceAffectsLayout:c,mode:l,onExitComplete:y?void 0:w,anchorX:p,children:x},d)})})},ee=({debts:n,onMarkPaid:a})=>{var f,p,o,u;const[s,r]=i.useState({isOpen:!1,debtId:null}),c=t=>{r({isOpen:!0,debtId:t})},l=()=>{s.debtId&&a(s.debtId),r({isOpen:!1,debtId:null})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-md font-medium text-[#263238] mb-3",children:"分帳關係"}),e.jsx("div",{className:"space-y-2",children:e.jsx(q,{children:n.length>0?n.map(t=>e.jsx(U.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.3}},className:"bg-white border border-gray-300 rounded-md p-3 flex flex-col items-center justify-between",children:e.jsxs("div",{className:"flex flex-col w-full gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 mr-2"}),e.jsx("span",{className:"text-sm text-[#263238]",children:t.from})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"➜"}),e.jsxs("span",{className:"text-sm text-[#EF4444] font-medium",children:["$",t.amount]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 mr-2"}),e.jsx("span",{className:"text-sm text-[#263238]",children:t.to})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-400",children:["（來自 ",t.event,"）"]}),e.jsx(I,{className:"w-[72px] h-[28px] text-xs bg-[#00C4CC] text-white rounded",onClick:()=>c(t.id),children:"標記已付"})]})]})},t.id)):e.jsx("p",{className:"text-sm text-[#9CA3AF] text-center",children:"目前無未還款債務"})})})]}),e.jsx(O,{open:s.isOpen,onOpenChange:t=>r({isOpen:t,debtId:null}),children:e.jsxs(z,{className:"sm:max-w-[425px] bg-white border border-gray-300 rounded-md p-4 text-black",children:[e.jsxs(F,{children:[e.jsx(L,{children:"確認標記已還款"}),e.jsx(A,{children:s.debtId&&n.find(t=>t.id===s.debtId)&&e.jsxs(e.Fragment,{children:["確定要標記這筆債務為已還款嗎？",e.jsxs("div",{className:"mt-2 p-3 bg-gray-50 rounded-md",children:[e.jsxs("p",{children:["付款人：",(f=n.find(t=>t.id===s.debtId))==null?void 0:f.from]}),e.jsxs("p",{children:["收款人：",(p=n.find(t=>t.id===s.debtId))==null?void 0:p.to]}),e.jsxs("p",{children:["金額：$",(o=n.find(t=>t.id===s.debtId))==null?void 0:o.amount]}),e.jsxs("p",{children:["來自：",(u=n.find(t=>t.id===s.debtId))==null?void 0:u.event]})]})]})})]}),e.jsxs(S,{className:"sm:justify-start",children:[e.jsx(I,{type:"button",variant:"secondary",onClick:()=>r({isOpen:!1,debtId:null}),children:"取消"}),e.jsx(I,{type:"button",onClick:l,className:"bg-[#00C4CC] hover:bg-[#00A3A9]",children:"確認已還款"})]})]})})]})};export{ee as D};
